<!DOCTYPE html>
<head>
  <meta charset="utf-8">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.4.11/d3.min.js"></script>
  <style>
    .node {
            stroke: white;
			stroke-width: 3;
        }

	.nodelabel {
	  font-family: "arial";
	   font-size:10px;

	}

	.link {
	  stroke: #999;
	  stroke-opacity: .6;
	}
  </style>
</head>

<body>
  <script>
     
		var graph = { 	"nodes":[
{"id":0,name:"","propertyValue":3,'x':208.012284784434, 'y':273.989995624911, 'fixed': true, "color_value":6,"proportions": [
{"group": 1 , "value": 15 },
{"group": 3 , "value": 15 },
{"group": 4 , "value": 15 },
{"group": 6 , "value": 15 }]},
{"id":1,name:"","propertyValue":3,'x':279.477267656623, 'y':191.259854268449, 'fixed': true, "color_value":6,"proportions": [
{"group": 1 , "value": 15 },
{"group": 4 , "value": 15 },
{"group": 5 , "value": 15 }]},
{"id":2,name:"","propertyValue":3,'x':138.508406278657, 'y':176.125372313377, 'fixed': true, "color_value":6,"proportions": [
{"group": 1 , "value": 15 }]},
{"id":3,name:"","propertyValue":3,'x':308.145651048745, 'y':287.590288702743, 'fixed': true, "color_value":6,"proportions": [
{"group": 1 , "value": 15 },
{"group": 4 , "value": 15 },
{"group": 5 , "value": 15 }]},
{"id":4,name:"","propertyValue":3,'x':337.911973143493, 'y':343.687833862226, 'fixed': true, "color_value":6,"proportions": [
{"group": 1 , "value": 15 },
{"group": 9 , "value": 15 }]},
{"id":5,name:"","propertyValue":3,'x':172.688784908154, 'y':256.522778141143, 'fixed': true, "color_value":6,"proportions": [
{"group": 1 , "value": 15 },
{"group": 3 , "value": 15 },
{"group": 4 , "value": 15 },
{"group": 5 , "value": 15 },
{"group": 6 , "value": 15 }]},
{"id":6,name:"","propertyValue":3,'x':196.667945837624, 'y':479.251984635809, 'fixed': true, "color_value":0,"proportions": [
{"group": 1 , "value": 15 },
{"group": 7 , "value": 15 }]},
{"id":7,name:"","propertyValue":3,'x':62.8003130198742, 'y':250.699749781527, 'fixed': true, "color_value":6,"proportions": [
{"group": 1 , "value": 15 }]},
{"id":8,name:"","propertyValue":3,'x':263.213962087662, 'y':301.473538444808, 'fixed': true, "color_value":6,"proportions": [
{"group": 1 , "value": 15 },
{"group": 4 , "value": 15 },
{"group": 5 , "value": 15 }]},
{"id":9,name:"","propertyValue":3,'x':251.512701197989, 'y':485.909296048098, 'fixed': true, "color_value":0,"proportions": [
{"group": 1 , "value": 15 },
{"group": 7 , "value": 15 },
{"group": 8 , "value": 15 }]},
{"id":10,name:"","propertyValue":3,'x':185.665572224803, 'y':235.309304898828, 'fixed': true, "color_value":6,"proportions": [
{"group": 1 , "value": 15 },
{"group": 3 , "value": 15 },
{"group": 4 , "value": 15 },
{"group": 5 , "value": 15 },
{"group": 6 , "value": 15 }]},
{"id":11,name:"","propertyValue":3,'x':315.766475042091, 'y':232.101998309879, 'fixed': true, "color_value":6,"proportions": [
{"group": 1 , "value": 15 },
{"group": 4 , "value": 15 },
{"group": 5 , "value": 15 }]},
{"id":12,name:"","propertyValue":3,'x':200.754783621177, 'y':336.914132925277, 'fixed': true, "color_value":6,"proportions": [
{"group": 1 , "value": 15 },
{"group": 3 , "value": 15 },
{"group": 4 , "value": 15 }]},
{"id":13,name:"","propertyValue":3,'x':507.19582271472, 'y':178.550805158047, 'fixed': true, "color_value":6,"proportions": [
{"group": 2 , "value": 15 }]},
{"id":14,name:"","propertyValue":3,'x':663.450857897792, 'y':173.572075416494, 'fixed': true, "color_value":0,"proportions": [
{"group": 2 , "value": 15 }]},
{"id":15,name:"","propertyValue":3,'x':503.580156944874, 'y':107.021952928519, 'fixed': true, "color_value":6,"proportions": [
{"group": 2 , "value": 15 }]},
{"id":16,name:"","propertyValue":3,'x':659.385213398408, 'y':20, 'fixed': true, "color_value":6,"proportions": [
{"group": 2 , "value": 15 }]},
{"id":17,name:"","propertyValue":3,'x':716.377427307309, 'y':117.52675651328, 'fixed': true, "color_value":6,"proportions": [
{"group": 2 , "value": 15 }]},
{"id":18,name:"","propertyValue":3,'x':601.820854255726, 'y':44.5097984084934, 'fixed': true, "color_value":6,"proportions": [
{"group": 2 , "value": 15 }]},
{"id":19,name:"","propertyValue":3,'x':448.37180264074, 'y':239.206992809579, 'fixed': true, "color_value":0,"proportions": [
{"group": 2 , "value": 15 },
{"group": 4 , "value": 15 },
{"group": 9 , "value": 15 }]},
{"id":20,name:"","propertyValue":3,'x':720, 'y':43.7909963370721, 'fixed': true, "color_value":6,"proportions": [
{"group": 2 , "value": 15 }]},
{"id":21,name:"","propertyValue":3,'x':567.851132929434, 'y':190.186471880106, 'fixed': true, "color_value":6,"proportions": [
{"group": 2 , "value": 15 }]},
{"id":22,name:"","propertyValue":3,'x':20, 'y':399.837677056673, 'fixed': true, "color_value":0,"proportions": [
{"group": 6 , "value": 15 }]},
{"id":23,name:"","propertyValue":3,'x':348.653727973112, 'y':552.197694704565, 'fixed': true, "color_value":6,"proportions": [
{"group": 7 , "value": 15 },
{"group": 8 , "value": 15 }]},
{"id":24,name:"","propertyValue":3,'x':301.016897268927, 'y':465.060194434276, 'fixed': true, "color_value":6,"proportions": [
{"group": 7 , "value": 15 },
{"group": 8 , "value": 15 }]},
{"id":25,name:"","propertyValue":3,'x':312.730120981827, 'y':720, 'fixed': true, "color_value":6,"proportions": [
{"group": 8 , "value": 15 }]},
],

						"links":[
{"source":14,"target":21},
{"source":14,"target":13},
{"source":14,"target":18},
{"source":14,"target":15},
{"source":14,"target":17},
{"source":14,"target":19},
{"source":16,"target":13},
{"source":16,"target":20},
{"source":16,"target":15},
{"source":16,"target":17},
{"source":21,"target":13},
{"source":21,"target":18},
{"source":21,"target":0},
{"source":21,"target":15},
{"source":21,"target":19},
{"source":13,"target":1},
{"source":13,"target":18},
{"source":13,"target":5},
{"source":13,"target":4},
{"source":13,"target":24},
{"source":13,"target":15},
{"source":13,"target":17},
{"source":13,"target":19},
{"source":1,"target":11},
{"source":1,"target":3},
{"source":1,"target":12},
{"source":1,"target":0},
{"source":1,"target":4},
{"source":1,"target":24},
{"source":1,"target":10},
{"source":1,"target":8},
{"source":18,"target":15},
{"source":18,"target":19},
{"source":20,"target":17},
{"source":5,"target":3},
{"source":5,"target":12},
{"source":5,"target":0},
{"source":5,"target":10},
{"source":5,"target":8},
{"source":11,"target":9},
{"source":11,"target":3},
{"source":11,"target":24},
{"source":11,"target":15},
{"source":11,"target":19},
{"source":11,"target":8},
{"source":9,"target":12},
{"source":9,"target":4},
{"source":9,"target":25},
{"source":9,"target":6},
{"source":9,"target":24},
{"source":3,"target":12},
{"source":3,"target":0},
{"source":3,"target":4},
{"source":3,"target":23},
{"source":3,"target":24},
{"source":3,"target":15},
{"source":3,"target":10},
{"source":3,"target":19},
{"source":3,"target":8},
{"source":12,"target":0},
{"source":12,"target":4},
{"source":12,"target":24},
{"source":12,"target":2},
{"source":12,"target":10},
{"source":12,"target":19},
{"source":12,"target":8},
{"source":0,"target":4},
{"source":0,"target":24},
{"source":0,"target":22},
{"source":0,"target":15},
{"source":0,"target":10},
{"source":0,"target":8},
{"source":4,"target":23},
{"source":4,"target":24},
{"source":4,"target":2},
{"source":4,"target":10},
{"source":4,"target":19},
{"source":4,"target":8},
{"source":23,"target":6},
{"source":23,"target":24},
{"source":23,"target":19},
{"source":25,"target":24},
{"source":6,"target":24},
{"source":24,"target":22},
{"source":24,"target":10},
{"source":24,"target":19},
{"source":24,"target":8},
{"source":15,"target":19},
{"source":10,"target":8},
]
    };
 var width = 10000,
			height = 10000,
			radius = 25,
			color = d3.scale.linear().domain([0,1,2,3,4,5,6,7,8,9,]).range(["#cccccc","#1B9E77","#D95F02","#7570B3","#E7298A","#66A61E","#E6AB02","#A6761D","#666666","#7FC97F",])
var color_border = d3.scale.category20();
              color_border(0);
              color_border(1);
              color_border(2);
              color_border(3);
              color_border(4);
              color_border(5);
              color_border(6);
              color_border(7);
              color_border(8);
              color_border(9);
			        color_border(10);
              color_border(11);
              color_border(12);
              color_border(13);
              color_border(14);
              color_border(15);
              color_border(16);
              color_border(17);
              color_border(18);
              color_border(19);
              
  var pie = d3.layout.pie()
			.sort(null)
			.value(function(d) { return d.value; });

		var arc = d3.svg.arc()
			.outerRadius(function(d) { return d.value; })
			.innerRadius(0);
		
		var zoomFlag = 0;
		
		var svg = d3.select("body").append("svg")
			.attr("width", width)
			.attr("height", height)
			//.style("border", "4px solid black")
			.attr("transform", "translate(5.684341886080802e-14,5.684341886080802e-14) scale(0.9999999999999999)") //TODO
			.call(d3.behavior.zoom().on("zoom", function () {
			svg.attr("transform", "translate(" + d3.event.translate + ")" + " scale(" + d3.event.scale + ")")
			//alert(d3.event.scale)
			if (!zoomFlag && d3.event.scale < 0.6){
				var nodelabels = g.selectAll(".nodelabel")
				nodelabels.text("")
				zoomFlag = 1
			}
			if (zoomFlag && d3.event.scale > 0.6){
				var nodelabels = g.selectAll(".nodelabel")
				.text(function(d){return d.name;});
				zoomFlag = 0
			}
		  }))
		  .on("dblclick.zoom", null)
		  .on("mousedown.zoom", null)
		  .append("g")
			.attr("transform", "translate(5.684341886080802e-14,5.684341886080802e-14) scale(0.9999999999999999)");
		  
		var g = d3.select("g");

		var force = d3.layout.force()
			.charge(-120)
			.linkDistance(100)
			.size([width, height]);

		force.nodes(graph.nodes)
			 .links(graph.links)
			 .start();

		var link = svg.selectAll(".link")
			.data(graph.links)
			.enter().append("line")
			.attr("class", "link");

		var node = svg.selectAll(".node")
			.data(graph.nodes)
			.enter().append("g")
			.attr("class", "node")
			.style("stroke", function(d) { return color_border(d.color_value); })
			.call(force.drag);
			
		var nodelabels = svg.selectAll(".nodelabel") 
			.data(graph.nodes)
			.enter()
			.append("text")
			.attr({"x":function(d){return d.x;},
				  "y":function(d){return d.y;},
				  "class":"nodelabel",
				  "stroke":"black"})
			.text(function(d){return d.name;});
			   
		node.selectAll("path")
			.data(function(d, i) {return pie(d.proportions); })
			.enter()
			.append("svg:path")
			.attr("d", arc)
			.attr("fill", function(d, i) { return color(d.data.group); });;

		force.on("tick", function() {
			link.attr("x1", function(d) { return d.source.x; })
			.attr("y1", function(d) { return d.source.y; })
			.attr("x2", function(d) { return d.target.x; })
			.attr("y2", function(d) { return d.target.y; });

			node.attr("x", function(d) { return d.x; })
				.attr("y", function(d) { return d.y; })
				.attr("transform", function(d) { return "translate(" + d.x + "," + d.y + ")"});
				
			nodelabels.attr("x", function(d) { return d.x; }) 
				.attr("y", function(d) { return d.y+3; });
		});
  </script>
</body>
              